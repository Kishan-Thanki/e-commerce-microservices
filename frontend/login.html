<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - MyStore</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/components.css"> </head>
<body>
    <div id="header-placeholder"></div>

    <main class="container">
        <h2>Login</h2>
        <div id="login-message-container" class="container" style="display:none;"></div>
        <form id="login-form">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit" class="button">Login</button>
        </form>
        <p>Don't have an account? <a href="/register.html">Register here</a>.</p>
    </main>

    <div id="footer-placeholder"></div>

    <script type="module" src="/static/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load header (adjust path if header.html is in /static/includes/)
            fetch('/header.html')
                .then(response => {
                    if (!response.ok) { throw new Error('Network response was not ok for header.html: ' + response.statusText); }
                    return response.text();
                })
                .then(html => { document.getElementById('header-placeholder').innerHTML = html; })
                .catch(error => console.error('Error loading header:', error));

            // Load footer (adjust path if footer.html is in /static/includes/)
            fetch('/footer.html')
                .then(response => {
                    if (!response.ok) { throw new Error('Network response was not ok for footer.html: ' + response.statusText); }
                    return response.text();
                })
                .then(html => { document.getElementById('footer-placeholder').innerHTML = html; })
                .catch(error => console.error('Error loading footer:', error));
        });
    </script>
    <script type="module">
        import { AuthModule } from '/static/js/modules/auth.js';
        import { showMessage } from '/static/js/main.js'; // Import showMessage

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            // Use showMessage with a specific container for login messages
            await AuthModule.login(username, password).catch(error => {
                showMessage('error', error.message || 'Login failed.', 'login-message-container');
            });
        });

        // Initialize message container display
        document.addEventListener('DOMContentLoaded', () => {
             const loginMessageContainer = document.getElementById('login-message-container');
             if (loginMessageContainer && !loginMessageContainer.innerHTML.trim()) {
                 loginMessageContainer.style.display = 'none';
             }
         });
    </script>
</body>
</html>